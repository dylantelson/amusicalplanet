{"ast":null,"code":"'use strict';\n\nvar superagent = require('superagent'),\n    {\n  TimeoutError,\n  WebapiError,\n  WebapiRegularError,\n  WebapiAuthenticationError,\n  WebapiPlayerError\n} = require('./response-error');\n\nvar HttpManager = {};\n/* Create superagent options from the base request */\n\nvar _getParametersFromRequest = function (request) {\n  var options = {};\n\n  if (request.getQueryParameters()) {\n    options.query = request.getQueryParameters();\n  }\n\n  if (request.getHeaders() && request.getHeaders()['Content-Type'] === 'application/json') {\n    options.data = JSON.stringify(request.getBodyParameters());\n  } else if (request.getBodyParameters()) {\n    options.data = request.getBodyParameters();\n  }\n\n  if (request.getHeaders()) {\n    options.headers = request.getHeaders();\n  }\n\n  return options;\n};\n\nvar _toError = function (response) {\n  if (typeof response.body === 'object' && response.body.error && typeof response.body.error === 'object' && response.body.error.reason) {\n    return new WebapiPlayerError(response.body, response.headers, response.statusCode);\n  }\n\n  if (typeof response.body === 'object' && response.body.error && typeof response.body.error === 'object') {\n    return new WebapiRegularError(response.body, response.headers, response.statusCode);\n  }\n\n  if (typeof response.body === 'object' && response.body.error && typeof response.body.error === 'string') {\n    return new WebapiAuthenticationError(response.body, response.headers, response.statusCode);\n  }\n  /* Other type of error, or unhandled Web API error format */\n\n\n  return new WebapiError(response.body, response.headers, response.statusCode, response.body);\n};\n/* Make the request to the Web API */\n\n\nHttpManager._makeRequest = function (method, options, uri, callback) {\n  var req = method.bind(superagent)(uri);\n\n  if (options.query) {\n    req.query(options.query);\n  }\n\n  if (options.headers) {\n    req.set(options.headers);\n  }\n\n  if (options.data) {\n    req.send(options.data);\n  }\n\n  req.end(function (err, response) {\n    if (err) {\n      if (err.timeout) {\n        return callback(new TimeoutError());\n      } else if (err.response) {\n        return callback(_toError(err.response));\n      } else {\n        return callback(err);\n      }\n    }\n\n    return callback(null, {\n      body: response.body,\n      headers: response.headers,\n      statusCode: response.statusCode\n    });\n  });\n};\n/**\n * Make a HTTP GET request.\n * @param {BaseRequest} The request.\n * @param {Function} The callback function.\n */\n\n\nHttpManager.get = function (request, callback) {\n  var options = _getParametersFromRequest(request);\n\n  var method = superagent.get;\n\n  HttpManager._makeRequest(method, options, request.getURI(), callback);\n};\n/**\n * Make a HTTP POST request.\n * @param {BaseRequest} The request.\n * @param {Function} The callback function.\n */\n\n\nHttpManager.post = function (request, callback) {\n  var options = _getParametersFromRequest(request);\n\n  var method = superagent.post;\n\n  HttpManager._makeRequest(method, options, request.getURI(), callback);\n};\n/**\n * Make a HTTP DELETE request.\n * @param {BaseRequest} The request.\n * @param {Function} The callback function.\n */\n\n\nHttpManager.del = function (request, callback) {\n  var options = _getParametersFromRequest(request);\n\n  var method = superagent.del;\n\n  HttpManager._makeRequest(method, options, request.getURI(), callback);\n};\n/**\n * Make a HTTP PUT request.\n * @param {BaseRequest} The request.\n * @param {Function} The callback function.\n */\n\n\nHttpManager.put = function (request, callback) {\n  var options = _getParametersFromRequest(request);\n\n  var method = superagent.put;\n\n  HttpManager._makeRequest(method, options, request.getURI(), callback);\n};\n\nmodule.exports = HttpManager;","map":{"version":3,"sources":["/home/dylan/MusicGuessr/a-musical-planet/node_modules/spotify-web-api-node/src/http-manager.js"],"names":["superagent","require","TimeoutError","WebapiError","WebapiRegularError","WebapiAuthenticationError","WebapiPlayerError","HttpManager","_getParametersFromRequest","request","options","getQueryParameters","query","getHeaders","data","JSON","stringify","getBodyParameters","headers","_toError","response","body","error","reason","statusCode","_makeRequest","method","uri","callback","req","bind","set","send","end","err","timeout","get","getURI","post","del","put","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nvar superagent = require('superagent'),\n  { TimeoutError, \n    WebapiError, \n    WebapiRegularError, \n    WebapiAuthenticationError,\n    WebapiPlayerError \n  } =  require('./response-error');\n\nvar HttpManager = {};\n\n/* Create superagent options from the base request */\nvar _getParametersFromRequest = function(request) {\n  var options = {};\n\n  if (request.getQueryParameters()) {\n    options.query = request.getQueryParameters();\n  }\n\n  if (request.getHeaders() && request.getHeaders()['Content-Type'] === 'application/json') {\n    options.data = JSON.stringify(request.getBodyParameters());\n  } else if (request.getBodyParameters()) {\n    options.data = request.getBodyParameters();\n  }\n\n  if (request.getHeaders()) {\n    options.headers = request.getHeaders();\n  }\n  return options;\n};\n\nvar _toError = function(response) {\n  if (typeof response.body === 'object' && response.body.error && typeof response.body.error === 'object' && response.body.error.reason) {\n    return new WebapiPlayerError(response.body, response.headers, response.statusCode);\n  }\n\n  if (typeof response.body === 'object' && response.body.error && typeof response.body.error === 'object') {\n    return new WebapiRegularError(response.body, response.headers, response.statusCode);\n  }\n\n  if (typeof response.body === 'object' && response.body.error && typeof response.body.error === 'string') {\n    return new WebapiAuthenticationError(response.body, response.headers, response.statusCode);\n  }\n  \n  /* Other type of error, or unhandled Web API error format */\n  return new WebapiError(response.body, response.headers, response.statusCode, response.body);\n};\n\n/* Make the request to the Web API */\nHttpManager._makeRequest = function(method, options, uri, callback) {\n  var req = method.bind(superagent)(uri);\n\n  if (options.query) {\n    req.query(options.query);\n  }\n\n  if (options.headers) {\n    req.set(options.headers);\n  }\n\n  if (options.data) {\n    req.send(options.data);\n  }\n\n  req.end(function(err, response) {\n    if (err) {\n      if (err.timeout) {\n        return callback(new TimeoutError());\n      } else if (err.response) {\n        return callback(_toError(err.response));\n      } else {\n        return callback(err);\n      }\n    }\n\n    return callback(null, {\n      body: response.body,\n      headers: response.headers,\n      statusCode: response.statusCode\n    });\n  });\n};\n\n/**\n * Make a HTTP GET request.\n * @param {BaseRequest} The request.\n * @param {Function} The callback function.\n */\nHttpManager.get = function(request, callback) {\n  var options = _getParametersFromRequest(request);\n  var method = superagent.get;\n\n  HttpManager._makeRequest(method, options, request.getURI(), callback);\n};\n\n/**\n * Make a HTTP POST request.\n * @param {BaseRequest} The request.\n * @param {Function} The callback function.\n */\nHttpManager.post = function(request, callback) {\n  var options = _getParametersFromRequest(request);\n  var method = superagent.post;\n\n  HttpManager._makeRequest(method, options, request.getURI(), callback);\n};\n\n/**\n * Make a HTTP DELETE request.\n * @param {BaseRequest} The request.\n * @param {Function} The callback function.\n */\nHttpManager.del = function(request, callback) {\n  var options = _getParametersFromRequest(request);\n  var method = superagent.del;\n\n  HttpManager._makeRequest(method, options, request.getURI(), callback);\n};\n\n/**\n * Make a HTTP PUT request.\n * @param {BaseRequest} The request.\n * @param {Function} The callback function.\n */\nHttpManager.put = function(request, callback) {\n  var options = _getParametersFromRequest(request);\n  var method = superagent.put;\n\n  HttpManager._makeRequest(method, options, request.getURI(), callback);\n};\n\nmodule.exports = HttpManager;"]},"metadata":{},"sourceType":"script"}